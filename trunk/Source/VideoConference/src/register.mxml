<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx" 
			   width="1200" height="620" backgroundAlpha="0"
			   chromeColor="#FFFFFF" pageTitle="DMC Flex Conference" applicationComplete="application1_applicationCompleteHandler(event)">
	
	<fx:Script>
		<![CDATA[
			import component.MD5;
			import component.Message;
			import component.checkRegister;
			import component.upload;
			
			import flash.sampler.NewObjectSample;
			
			import mx.controls.Alert;
			import mx.core.mx_internal;
			import mx.events.FlexEvent;
			import mx.events.Request;
			import mx.managers.PopUpManager;
			import mx.rpc.Fault;
			import mx.rpc.events.ResultEvent;
			
			import object.User;		
			
			protected function close_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				PopUpManager.removePopUp(this);			
			}
			
			protected function signUp_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				var tmp:checkRegister = new checkRegister();
				
				if (tmp.run(txt_username.text, txt_password.text, txt_retype_pass.text, txt_email.text,this) == true)
				{
					var user:User = new User();
					user.fullname = txt_fullname.text;
					user.user_name = txt_username.text;
					user.password = MD5.encrypt(txt_password.text);
					user.email = txt_email.text;
					user.subcriptions = rd_free.selected==true?1:rd_basic.selected==true?2:3;
					user.avartar = "test";
					ro.createUser(user);
				}
			}
			
			protected function computer_clickHandler(event:MouseEvent):void
				
			{
				// TODO Auto-generated method stub
//				var request:URLRequest = new URLRequest;
//				request.url = upload;
				
			}
			
			protected function webcam_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
			}
			
			protected function createUser_resultHandler(event:ResultEvent):void
			{
				Message.show("Your account has been created successfully and is ready to use",Message.Information,this,true);
				PopUpManager.removePopUp(this);
				txt_fullname.text = null;
				txt_username.text=null;
				txt_password.text=null;
				txt_retype_pass.text = null;
				txt_email.text = null;
				rd_free.selected = true;
				txt_fullname.setFocus();
			}
			
			protected function application1_applicationCompleteHandler(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				txt_fullname.setFocus();
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<s:RemoteObject id="ro" destination="UserService" showBusyCursor="true">
			<s:method name="createUser" result="createUser_resultHandler(event)" fault="Alert.show(event.fault.faultString)"/>
			<s:method name="getUser"/>	
		</s:RemoteObject>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	
	<fx:Style source="conferenceSkin.css"/>
	
	<s:Image x="375" y="47" width="450" height="480" source="@Embed(source='images/boder3.png')"/>
	
	<s:Label x="468" y="77" text="Fullname: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="460" y="107" text="Username: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="461" y="138" text="Password: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="415" y="168" text="Re-type Password: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="488" y="197" text="Email: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="440" y="243" text="Subscriptions: " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="486" y="334" text="Avatar " height="22" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="551" y="240" text="Free" width="70" height="30" fontSize="16" fontWeight="bold" textAlign="center" verticalAlign="middle"/>
	<s:Label x="629" y="240" text="Basic" width="70" height="30" fontSize="16" fontWeight="bold" textAlign="center" verticalAlign="middle" backgroundColor="#000000" color="#FFFFFF"/>
	<s:Label x="707" y="240" text="Gold" width="70" height="30" fontSize="16" fontWeight="bold" textAlign="center" verticalAlign="middle" backgroundColor="#000000" color="#FFFF00"/>
	<s:RadioButton styleName="sub_radio" id="rd_free" selected="true" x="581" y="278" value="1"/>
	<s:RadioButton styleName="sub_radio" id="rd_basic" x="659" y="278" value="2"/>
	<s:RadioButton styleName="sub_radio" id="rd_gold" x="736" y="278" value="3"/>
	

	<s:TextInput id="txt_retype_pass" displayAsPassword="true" x="551" y="167" tabIndex="3"/>
	<s:TextInput id="txt_email" x="551" y="197" tabIndex="4"/>
	<s:TextInput id="txt_password" displayAsPassword="true" x="551" y="137" tabIndex="2"/>
	<s:TextInput id="txt_fullname" x="551" y="77" tabIndex="0"/>
	<s:TextInput id="txt_username" x="551" y="107" tabIndex="1"/>
	
	
	<s:Image x="551" y="314" width="126" height="126" source="@Embed(source='images/avatar.png')"/>
	<s:Image id="close" x="798" y="53" width="20" height="20" source="@Embed(source='images/button_close.png')" click="close_clickHandler(event)" useHandCursor="true" buttonMode="true" mouseChildren="false"/>
	
	<s:Button id="btn_computer" x="707" y="332" label="Computer" click="computer_clickHandler(event)"/>
<!--	<s:Button id="webcam" x="707" y="366" width="76" label="Webcam" click="webcam_clickHandler(event)"/> -->
	
	
	<s:Label id="lbl_signUp" x="565" y="467" text="Sign Up" width="71" height="30" fontWeight="bold" textAlign="center" verticalAlign="middle" backgroundColor="#000000" color="#FFFFFF" click="signUp_clickHandler(event)" useHandCursor="true" buttonMode="true" mouseChildren="false"/>
	
</s:Application>
